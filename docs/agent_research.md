# AgentæŠ€æœ¯é€‰å‹è°ƒç ”æŠ¥å‘Š
# åŠŸèƒ½ï¼šåˆ†æAgentå½¢å¼åœ¨å†…å®¹ç”Ÿäº§ç³»ç»Ÿä¸­çš„é€‚ç”¨æ€§å’ŒæŠ€æœ¯é€‰å‹
# åŸåˆ™ï¼šåŠ¡å®æœ‰æ•ˆï¼Œæ‹’ç»ä¸ºäº†ç”¨è€Œç”¨

---

## ä¸€ã€æ ¸å¿ƒé—®é¢˜æ¾„æ¸…

### 1.1 ä½ ä¹‹å‰çš„å®è·µ vs Agentæ¨¡å¼

```
âŒ ä¹‹å‰çš„æ¨¡å¼ï¼šLLMä½œä¸º"èŠ‚ç‚¹"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å…¥æ–‡æœ¬  â”‚ â”€â”€â–¶ â”‚   LLM    â”‚ â”€â”€â–¶ â”‚ è¾“å‡ºæ–‡æœ¬  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç‰¹ç‚¹ï¼šå•å‘ã€æ— çŠ¶æ€ã€æ— åé¦ˆå¾ªç¯ã€æ— å†³ç­–

âœ… Agentæ¨¡å¼ï¼šLLMä½œä¸º"è°ƒåº¦è€…"
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         Agent (LLM)            â”‚
                    â”‚   ç†è§£æ„å›¾ â†’ é€‰æ‹©Tool â†’ è¯„ä¼°    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“  â†‘
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â†“                  â†“                      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Skill A  â”‚       â”‚ Skill B  â”‚          â”‚ è¯„ä¼°Tool â”‚
    â”‚(è¯¾ç¨‹å“ç±») â”‚       â”‚(è¥é”€å“ç±») â”‚          â”‚(Simulator)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“                  â†“                      â†‘
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        åé¦ˆå¾ªç¯ï¼ˆè‡ªè¿­ä»£ï¼‰

ç‰¹ç‚¹ï¼šæœ‰å†³ç­–ã€æœ‰çŠ¶æ€ã€æœ‰åé¦ˆå¾ªç¯
```

### 1.2 å³ä¾§å¯¹è¯æ¡† = å…¨å±€è°ƒåº¦Agent

**ä½ çš„ç†è§£å®Œå…¨æ­£ç¡®**ã€‚å¯¹è¯æ¡†æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªAgentçš„UIå…¥å£ï¼š

```yaml
AgentèŒè´£:
  1. ç†è§£ç”¨æˆ·æ„å›¾ï¼ˆ"æˆ‘æƒ³å†™ä¸€ä¸ªè¯¾ç¨‹ä»‹ç»é¡µ"ï¼‰
  2. é€‰æ‹©åˆé€‚çš„Skillï¼ˆè°ƒç”¨"è¯¾ç¨‹ä»‹ç»é¡µ"å“ç±»çš„ç”ŸæˆToolï¼‰
  3. ä¼ å…¥ä¸Šä¸‹æ–‡ï¼ˆCreatorProfileã€FieldSchemaç­‰ï¼‰
  4. ç›‘æ§æ‰§è¡Œç»“æœï¼ˆSimulatorè¯„ä¼°ï¼‰
  5. å†³å®šæ˜¯å¦è¿­ä»£ï¼ˆåŸºäºè¯„ä¼°è§¦å‘é‡æ–°ç”Ÿæˆï¼‰
  6. æ›´æ–°çŠ¶æ€ï¼ˆå·¦ä¾§è¿›åº¦ã€ä¸­é—´ç¼–è¾‘åŒºï¼‰
```

---

## äºŒã€æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

### 2.1 è°ƒç ”å¯¹è±¡

| æ¡†æ¶/å·¥å…· | ç±»å‹ | æ ¸å¿ƒèƒ½åŠ› |
|----------|------|---------|
| **LangGraph** | Agentç¼–æ’æ¡†æ¶ | çŠ¶æ€å›¾ã€æ¡ä»¶è·¯ç”±ã€Toolè°ƒç”¨ |
| **LangChain LCEL** | é“¾å¼è°ƒç”¨æ¡†æ¶ | å£°æ˜å¼é“¾ã€æµå¼è¾“å‡º |
| **OpenAI Function Calling** | åŸç”ŸAPIèƒ½åŠ› | Toolå®šä¹‰ã€å¹¶è¡Œè°ƒç”¨ |
| **Claude Tool Use** | åŸç”ŸAPIèƒ½åŠ› | Toolå®šä¹‰ã€ç»“æ„åŒ–è¾“å‡º |
| **Claude Code/OpenCode/Cline** | ç¼–ç åŠ©æ‰‹ | ä»£ç ç”Ÿæˆã€æ–‡ä»¶æ“ä½œ |

### 2.2 é€‚é…åº¦è¯„ä¼°

| æ¡†æ¶ | é€‚é…åº¦ | åŸå›  | é£é™© |
|------|-------|------|------|
| **LangGraph** | â­â­â­â­â­ | å¤©ç„¶æ”¯æŒçŠ¶æ€ç®¡ç†ã€æ¡ä»¶åˆ†æ”¯ã€è‡ªè¿­ä»£ | éœ€è¦å­¦ä¹ æ›²çº¿ |
| **çº¯Tool Calling** | â­â­â­â­ | ç®€å•ç›´æ¥ï¼Œé›¶æ¡†æ¶ä¾èµ– | çŠ¶æ€ç®¡ç†éœ€è‡ªå·±å†™ |
| **LangChain LCEL** | â­â­â­ | Skillå†…éƒ¨é“¾å¼è°ƒç”¨å¯ç”¨ | ä¸é€‚åˆå…¨å±€ç¼–æ’ |
| **Claude Codeç­‰** | â­â­ | æ˜¯å¼€å‘å·¥å…·ï¼Œä¸æ˜¯è¿è¡Œæ—¶æ¡†æ¶ | ç”¨é€”ä¸å¯¹å£ |

### 2.3 æ ¸å¿ƒç»“è®º

```yaml
æ¨èæ–¹æ¡ˆï¼ˆåˆ†å±‚è®¾è®¡ï¼‰:

å±‚1 - å…¨å±€è°ƒåº¦: LangGraph StateGraph
     ç”¨é€”: ç®¡ç†æ•´ä¸ªæµç¨‹çš„çŠ¶æ€ã€å†³ç­–è·¯ç”±ã€è‡ªè¿­ä»£è§¦å‘
     
å±‚2 - Skillæ‰§è¡Œ: åŸç”ŸTool Calling (OpenAI/Claude)
     ç”¨é€”: æ¯ä¸ªå“ç±»çš„å†…å®¹ç”Ÿæˆæ˜¯ä¸€ä¸ªTool
     
å±‚3 - é“¾å¼ç»†èŠ‚: å¯é€‰LCELæˆ–çº¯Python
     ç”¨é€”: Skillå†…éƒ¨çš„promptç»„è£…ã€è¾“å‡ºè§£æ
```

---

## ä¸‰ã€ä¸ºä»€ä¹ˆé€‰æ‹©LangGraph

### 3.1 StateGraph å¯¹åº”ä½ çš„ç³»ç»Ÿè®¾è®¡

```
ä½ çš„ç³»ç»Ÿ                          LangGraphæ¦‚å¿µ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å·¦ä¾§è¿›åº¦æ                    â†â†’   StateèŠ‚ç‚¹åºåˆ—
ä¸­é—´ç¼–è¾‘åŒº                   â†â†’   Stateä¸­çš„contentå­—æ®µ
å³ä¾§å¯¹è¯æ¡†                   â†â†’   Agent invokeå…¥å£
å„é˜¶æ®µçš„æµè½¬                 â†â†’   Edgeå®šä¹‰
è‡ªè¿­ä»£è§¦å‘                   â†â†’   Conditional Edge
Simulatorè¯„ä¼°                â†â†’   ä½œä¸ºä¸€ä¸ªNode
```

### 3.2 ä»£ç ç¤ºæ„

```python
from langgraph.graph import StateGraph, END
from typing import TypedDict, Literal

# å®šä¹‰å…¨å±€çŠ¶æ€ï¼ˆå¯¹åº”ä½ çš„ç³»ç»ŸçŠ¶æ€ï¼‰
class ContentState(TypedDict):
    # å¯¹è¯å†å²
    messages: list
    # å½“å‰é˜¶æ®µ
    current_stage: str  # "intent" | "research" | "core" | "extension" | "done"
    # åˆ›ä½œè€…ç‰¹è´¨
    creator_profile: dict
    # å†…å®¹äº§å‡º
    content: dict
    # è¯„ä¼°ç»“æœ
    evaluation: dict | None
    # è¿­ä»£è®¡æ•°
    iteration_count: int

# æ„å»ºçŠ¶æ€å›¾
graph = StateGraph(ContentState)

# æ·»åŠ èŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼‰
graph.add_node("understand_intent", understand_intent_node)
graph.add_node("select_skill", select_skill_node)
graph.add_node("execute_skill", execute_skill_node)
graph.add_node("evaluate", evaluate_node)
graph.add_node("update_ui", update_ui_node)

# æ·»åŠ è¾¹ï¼ˆå®šä¹‰æµè½¬ï¼‰
graph.add_edge("understand_intent", "select_skill")
graph.add_edge("select_skill", "execute_skill")
graph.add_edge("execute_skill", "evaluate")

# æ¡ä»¶è¾¹ï¼šè‡ªè¿­ä»£çš„æ ¸å¿ƒ
def should_iterate(state: ContentState) -> Literal["iterate", "done"]:
    """æ ¹æ®è¯„ä¼°ç»“æœå†³å®šæ˜¯å¦è¿­ä»£"""
    if state["evaluation"] is None:
        return "done"
    if state["evaluation"].get("score", 10) < 7:
        if state["iteration_count"] < 3:
            return "iterate"
    return "done"

graph.add_conditional_edges(
    "evaluate",
    should_iterate,
    {
        "iterate": "execute_skill",  # é‡æ–°æ‰§è¡ŒSkill
        "done": "update_ui"
    }
)

graph.add_edge("update_ui", END)

# ç¼–è¯‘
agent = graph.compile()
```

### 3.3 å¯¹è¯æ¡†ä¸­çš„è°ƒç”¨

```python
async def handle_user_message(user_input: str, current_state: ContentState):
    """å³ä¾§å¯¹è¯æ¡†çš„æ¶ˆæ¯å¤„ç†"""
    
    # æ›´æ–°å¯¹è¯å†å²
    current_state["messages"].append({"role": "user", "content": user_input})
    
    # è°ƒç”¨Agentï¼ˆå¼‚æ­¥æµå¼ï¼‰
    async for event in agent.astream(current_state):
        # å®æ—¶æ›´æ–°UI
        if "content" in event:
            yield {"type": "editor_update", "data": event["content"]}
        if "current_stage" in event:
            yield {"type": "progress_update", "data": event["current_stage"]}
        if "messages" in event:
            yield {"type": "chat_update", "data": event["messages"][-1]}
```

---

## å››ã€Skillä½œä¸ºToolçš„è®¾è®¡

### 4.1 Skill = Tool + Context

```python
from langchain.tools import BaseTool

class ContentSkill(BaseTool):
    """å“ç±»å†…å®¹ç”ŸæˆSkillçš„åŸºç±»"""
    
    name: str = "content_skill"
    description: str = "ç”Ÿæˆç‰¹å®šå“ç±»çš„å†…å®¹"
    
    # Skilléœ€è¦çš„ä¸Šä¸‹æ–‡
    creator_profile: dict
    field_schema: dict
    
    def _run(self, 
             intent: str,
             consumer_research: str | None = None) -> dict:
        """
        æ‰§è¡ŒSkill
        
        Args:
            intent: ç”¨æˆ·æ„å›¾æè¿°
            consumer_research: æ¶ˆè´¹è€…è°ƒç ”ï¼ˆå¯é€‰ï¼‰
            
        Returns:
            ç”Ÿæˆçš„å†…å®¹ï¼ˆæŒ‰field_schemaç»“æ„ï¼‰
        """
        # 1. æ„å»ºpromptï¼ˆæ³¨å…¥creator_profileï¼‰
        prompt = self.build_prompt(intent, consumer_research)
        
        # 2. è°ƒç”¨LLM
        response = llm.invoke(prompt)
        
        # 3. è§£æè¾“å‡ºï¼ˆæŒ‰field_schemaï¼‰
        content = self.parse_output(response)
        
        return content

# ç¤ºä¾‹ï¼šè¯¾ç¨‹ä»‹ç»é¡µSkill
class CourseIntroSkill(ContentSkill):
    name = "course_intro_generator"
    description = "ç”Ÿæˆè¯¾ç¨‹ä»‹ç»é¡µå†…å®¹ï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ‰¿è¯ºã€ç—›ç‚¹ã€è§£å†³æ–¹æ¡ˆç­‰"
    
    def build_prompt(self, intent, consumer_research):
        return f"""
        ä½ æ­£åœ¨ä¸ºä»¥ä¸‹åˆ›ä½œè€…ç”Ÿäº§å†…å®¹ï¼š
        {self.format_creator_profile()}
        
        ç›®æ ‡ç”¨æˆ·ï¼š
        {consumer_research or "æ ¹æ®æ„å›¾æ¨æ–­"}
        
        è¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„ç”Ÿæˆè¯¾ç¨‹ä»‹ç»é¡µï¼š
        {self.format_field_schema()}
        
        ç”¨æˆ·æ„å›¾ï¼š{intent}
        """
```

### 4.2 ç”¨æˆ·è‡ªå®šä¹‰Skill

```python
# ç”¨æˆ·é€šè¿‡UIå®šä¹‰çš„Skillï¼Œè¿è¡Œæ—¶åŠ¨æ€åŠ è½½
class UserDefinedSkill(ContentSkill):
    """ç”¨æˆ·è‡ªå®šä¹‰çš„å“ç±»Skill"""
    
    def __init__(self, 
                 skill_config: dict,  # ç”¨æˆ·åœ¨UIä¸­å®šä¹‰çš„é…ç½®
                 creator_profile: dict,
                 field_schema: dict):
        self.name = skill_config["name"]
        self.description = skill_config["description"]
        self.prompt_template = skill_config["prompt_template"]  # ç”¨æˆ·å†™çš„prompt
        self.creator_profile = creator_profile
        self.field_schema = field_schema
    
    def build_prompt(self, intent, consumer_research):
        # ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„promptæ¨¡æ¿
        return self.prompt_template.format(
            creator_profile=self.format_creator_profile(),
            field_schema=self.format_field_schema(),
            consumer_research=consumer_research,
            intent=intent
        )
```

---

## äº”ã€è‡ªè¿­ä»£æœºåˆ¶è¯¦è§£

### 5.1 è§¦å‘æ¡ä»¶ï¼ˆä½ å¼ºè°ƒçš„"éœ€è¦è§¦å‘"ï¼‰

```python
class IterationConfig:
    """è‡ªè¿­ä»£é…ç½®ï¼ˆç”¨æˆ·å¯å®šä¹‰ï¼‰"""
    
    # è‡ªåŠ¨è§¦å‘æ¡ä»¶
    auto_triggers = [
        {"type": "score_below", "threshold": 6},
        {"type": "keyword_detected", "keywords": ["ä¸é€šè¿‡", "éœ€è¦æ”¹"]},
    ]
    
    # åœæ­¢æ¡ä»¶
    stop_conditions = [
        {"type": "score_above", "threshold": 8},
        {"type": "max_iterations", "limit": 3},
        {"type": "user_approved"},  # ç”¨æˆ·åœ¨å¯¹è¯æ¡†è¯´"å¯ä»¥äº†"
    ]
    
    # æ‰‹åŠ¨è§¦å‘
    manual_trigger = True  # ç”¨æˆ·å¯ä»¥éšæ—¶è¯´"é‡æ–°ç”Ÿæˆ"

def should_iterate(state: ContentState, config: IterationConfig) -> bool:
    """åˆ¤æ–­æ˜¯å¦éœ€è¦è¿­ä»£"""
    
    # æ£€æŸ¥åœæ­¢æ¡ä»¶
    for stop in config.stop_conditions:
        if stop["type"] == "max_iterations":
            if state["iteration_count"] >= stop["limit"]:
                return False
        if stop["type"] == "score_above":
            if state["evaluation"]["score"] >= stop["threshold"]:
                return False
        if stop["type"] == "user_approved":
            if "approved" in state["messages"][-1].get("content", "").lower():
                return False
    
    # æ£€æŸ¥è§¦å‘æ¡ä»¶
    for trigger in config.auto_triggers:
        if trigger["type"] == "score_below":
            if state["evaluation"]["score"] < trigger["threshold"]:
                return True
    
    return False
```

### 5.2 è¿­ä»£æ—¶çš„ä¸Šä¸‹æ–‡ä¼ é€’

```python
def execute_skill_with_feedback(state: ContentState) -> ContentState:
    """å¸¦åé¦ˆçš„Skillæ‰§è¡Œ"""
    
    skill = get_skill(state["current_skill"])
    
    # å¦‚æœæ˜¯è¿­ä»£ï¼Œæ³¨å…¥ä¸Šä¸€æ¬¡çš„è¯„ä¼°åé¦ˆ
    if state["iteration_count"] > 0:
        feedback = state["evaluation"]["feedback"]
        intent = f"""
        åŸéœ€æ±‚ï¼š{state["original_intent"]}
        
        ä¸Šä¸€ç‰ˆæœ¬çš„é—®é¢˜ï¼š
        {feedback}
        
        è¯·åŸºäºåé¦ˆæ”¹è¿›ï¼Œä¿ç•™å¥½çš„éƒ¨åˆ†ã€‚
        """
    else:
        intent = state["original_intent"]
    
    # æ‰§è¡ŒSkill
    content = skill.run(intent=intent)
    
    # æ›´æ–°çŠ¶æ€
    state["content"] = content
    state["iteration_count"] += 1
    
    return state
```

---

## å…­ã€ä¸UIçš„è”åŠ¨

### 6.1 ä¸‰æ å¸ƒå±€ â†” AgentçŠ¶æ€æ˜ å°„

```yaml
å·¦ä¾§è¿›åº¦æ :
  æ•°æ®æ¥æº: state["current_stage"]
  æ›´æ–°æ—¶æœº: æ¯æ¬¡èŠ‚ç‚¹æ‰§è¡Œå®Œæ¯•
  äº¤äº’: ç‚¹å‡»é˜¶æ®µ â†’ å›æº¯åˆ°è¯¥é˜¶æ®µçš„çŠ¶æ€

ä¸­é—´ç¼–è¾‘åŒº:
  æ•°æ®æ¥æº: state["content"]
  æ›´æ–°æ—¶æœº: Skillæ‰§è¡Œåã€è¿­ä»£å
  äº¤äº’: ç”¨æˆ·ç¼–è¾‘ â†’ æ›´æ–°state â†’ å¯é€‰è§¦å‘é‡æ–°è¯„ä¼°

å³ä¾§å¯¹è¯æ¡†:
  æ•°æ®æ¥æº: state["messages"]
  è¾“å…¥: ç”¨æˆ·æ¶ˆæ¯ â†’ agent.invoke()
  è¾“å‡º: Agentæ¨ç†è¿‡ç¨‹ + Skillè°ƒç”¨ç»“æœ
```

### 6.2 æµå¼è¾“å‡º

```python
async def stream_agent_response(state: ContentState):
    """æµå¼è¾“å‡ºAgentçš„æ‰§è¡Œè¿‡ç¨‹åˆ°å¯¹è¯æ¡†"""
    
    async for event in agent.astream(state, stream_mode="updates"):
        node_name = list(event.keys())[0]
        node_output = event[node_name]
        
        if node_name == "understand_intent":
            yield f"ğŸ¤” ç†è§£ä¸­ï¼š{node_output['parsed_intent']}"
        
        elif node_name == "select_skill":
            yield f"ğŸ”§ é€‰æ‹©Skillï¼š{node_output['selected_skill']}"
        
        elif node_name == "execute_skill":
            yield f"âœï¸ æ­£åœ¨ç”Ÿæˆ..."
            # å†…å®¹æ›´æ–°åˆ°ç¼–è¾‘åŒº
            yield {"type": "editor", "content": node_output["content"]}
        
        elif node_name == "evaluate":
            score = node_output["score"]
            yield f"ğŸ“Š è¯„ä¼°å¾—åˆ†ï¼š{score}/10"
            if score < 7:
                yield f"ğŸ”„ å¾—åˆ†è¾ƒä½ï¼Œæ­£åœ¨æ”¹è¿›..."
```

---

## ä¸ƒã€ä¸éœ€è¦Agentçš„åœºæ™¯

### 7.1 æ˜ç¡®ä¸éœ€è¦çš„

```yaml
âŒ ä¸éœ€è¦å¤šAgentåä½œ:
   - ä½ çš„ç³»ç»Ÿæ˜¯å•ä¸€Agent + å¤šTool
   - ä¸éœ€è¦"è§„åˆ’Agent"å’Œ"æ‰§è¡ŒAgent"åˆ†ç¦»
   - ä¸€ä¸ªAgentè¶³å¤Ÿ

âŒ ä¸éœ€è¦å¤æ‚çš„è®°å¿†ç³»ç»Ÿ:
   - å¯¹è¯å†å²è¶³å¤Ÿï¼ˆä¸éœ€è¦å‘é‡æ•°æ®åº“å­˜å‚¨ï¼‰
   - CreatorProfileæ˜¯æ˜¾å¼é…ç½®ï¼Œä¸éœ€è¦"è®°å¿†"

âŒ ä¸éœ€è¦ReActå¾ªç¯:
   - ä½ çš„æµç¨‹æ˜¯ç¡®å®šçš„ï¼ˆæ„å›¾â†’è°ƒç ”â†’å†…æ¶µâ†’å¤–å»¶ï¼‰
   - ä¸éœ€è¦"æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿ"çš„å¼€æ”¾æ¢ç´¢

âŒ ä¸éœ€è¦RAG:
   - é™¤éä½ è¦ä»å¤–éƒ¨çŸ¥è¯†åº“æ£€ç´¢å“ç±»æ¨¡æ¿
   - å½“å‰è®¾è®¡ä¸­FieldSchemaæ˜¯ç”¨æˆ·å®šä¹‰çš„ï¼Œä¸éœ€è¦æ£€ç´¢
```

### 7.2 æœ€å°åŒ–å®ç°è·¯å¾„

```yaml
å¦‚æœä¸æƒ³å¼•å…¥LangGraph:
  
  å¯ä»¥ç”¨çº¯Pythonå®ç°ç­‰æ•ˆé€»è¾‘:
  
  class SimpleOrchestrator:
      def __init__(self, skills: dict):
          self.skills = skills
          self.state = {}
      
      async def run(self, user_input: str):
          # 1. ç†è§£æ„å›¾ï¼ˆä¸€æ¬¡LLMè°ƒç”¨ï¼‰
          intent = await self.parse_intent(user_input)
          
          # 2. é€‰æ‹©Skillï¼ˆè§„åˆ™æˆ–LLMï¼‰
          skill = self.select_skill(intent)
          
          # 3. æ‰§è¡ŒSkill
          content = await skill.run(intent)
          
          # 4. è¯„ä¼°
          eval_result = await self.evaluate(content)
          
          # 5. è¿­ä»£ï¼ˆç®€å•å¾ªç¯ï¼‰
          while self.should_iterate(eval_result):
              content = await skill.run(intent, feedback=eval_result)
              eval_result = await self.evaluate(content)
          
          return content
  
  ä¼˜ç‚¹: é›¶ä¾èµ–ï¼Œå®Œå…¨å¯æ§
  ç¼ºç‚¹: çŠ¶æ€ç®¡ç†ã€é”™è¯¯æ¢å¤ã€æµå¼è¾“å‡ºéœ€è¦è‡ªå·±å†™
```

---

## å…«ã€æœ€ç»ˆå»ºè®®

### 8.1 æ¨èæŠ€æœ¯æ ˆ

```yaml
MVPé˜¶æ®µï¼ˆéªŒè¯æ ¸å¿ƒæµç¨‹ï¼‰:
  è°ƒåº¦å±‚: çº¯Python Orchestratorï¼ˆ50-100è¡Œä»£ç ï¼‰
  Skillå±‚: ç›´æ¥è°ƒç”¨OpenAI/Claude API
  UIå±‚: ç®€å•çš„CLIæˆ–Streamlit
  
  ç†ç”±: æœ€å¿«éªŒè¯ï¼Œä¸å¼•å…¥æ¡†æ¶å¤æ‚æ€§

æ‰©å±•é˜¶æ®µï¼ˆéœ€è¦ä»¥ä¸‹èƒ½åŠ›æ—¶å‡çº§åˆ°LangGraphï¼‰:
  - å¤æ‚çš„æ¡ä»¶åˆ†æ”¯ï¼ˆè¶…è¿‡3å±‚if-elseï¼‰
  - éœ€è¦ä¸­é—´çŠ¶æ€æŒä¹…åŒ–ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰
  - éœ€è¦è¯¦ç»†çš„æ‰§è¡Œè¿½è¸ªï¼ˆdebug/ç›‘æ§ï¼‰
  - å¤šäººåä½œç¼–è¾‘åŒä¸€é¡¹ç›®
```

### 8.2 å…³é”®å†³ç­–ç‚¹

| å†³ç­– | é€‰æ‹© | ç†ç”± |
|------|------|------|
| å…¨å±€è°ƒåº¦ | LangGraph æˆ– è‡ªå»ºOrchestrator | å–å†³äºæµç¨‹å¤æ‚åº¦ |
| Skillå®ç° | Tool Calling | æ ‡å‡†åŒ–ï¼Œæ˜“äºæ‰©å±• |
| å¯¹è¯æ¡† | æµå¼è¾“å‡º | ç”¨æˆ·ä½“éªŒ |
| è‡ªè¿­ä»£ | æ¡ä»¶è§¦å‘ | é¿å…æ— é™å¾ªç¯ |
| çŠ¶æ€å­˜å‚¨ | å†…å­˜ + æ–‡ä»¶ç³»ç»Ÿ | MVPå¤Ÿç”¨ |

### 8.3 é¿å…çš„é™·é˜±

```yaml
âŒ é™·é˜±1: ä¸ºäº†ç”¨Agentè€Œç”¨Agent
   è¡¨ç°: æŠŠç®€å•çš„Promptå˜æˆå¤æ‚çš„å¤šæ­¥æ¨ç†
   è§£æ³•: å¦‚æœä¸€æ¬¡LLMè°ƒç”¨èƒ½è§£å†³ï¼Œå°±ä¸è¦æ‹†æˆå¤šæ­¥

âŒ é™·é˜±2: è¿‡åº¦æŠ½è±¡Skill
   è¡¨ç°: æ¯ä¸ªå°åŠŸèƒ½éƒ½å°è£…æˆTool
   è§£æ³•: ä¸€ä¸ªå“ç±» = ä¸€ä¸ªSkillï¼Œå†…éƒ¨é€»è¾‘å¯ä»¥æ˜¯ç®€å•çš„Prompt

âŒ é™·é˜±3: å¤æ‚çš„ä¸Šä¸‹æ–‡ç®¡ç†
   è¡¨ç°: æŠŠæ‰€æœ‰å†å²éƒ½å¡è¿›context
   è§£æ³•: åªä¼ å¿…è¦çš„ï¼ˆCreatorProfile + å½“å‰é˜¶æ®µäº§å‡º + è¯„ä¼°åé¦ˆï¼‰

âŒ é™·é˜±4: ä¾èµ–LLMåšæ‰€æœ‰å†³ç­–
   è¡¨ç°: è®©LLMå†³å®š"æ˜¯å¦è¿­ä»£"
   è§£æ³•: ç”¨è§„åˆ™ï¼ˆåˆ†æ•°é˜ˆå€¼ï¼‰+ ç”¨æˆ·ç¡®è®¤ï¼Œä¸è¦è®©LLMè‡ªå·±åˆ¤æ–­
```

---

## ä¹ã€ä¸ç°æœ‰æ¶æ„çš„æ•´åˆ

### 9.1 æ›´æ–°åçš„æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            UIå±‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¿›åº¦æ    â”‚    â”‚        ç¼–è¾‘åŒº           â”‚    â”‚   å¯¹è¯åŒº      â”‚  â”‚
â”‚  â”‚ (State)  â”‚    â”‚    (Content Output)     â”‚    â”‚ (Agentå…¥å£)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†‘â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Agentå±‚ (Orchestrator)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   StateGraph / SimpleOrchestrator                            â”‚  â”‚
â”‚  â”‚   â”œâ”€ ç†è§£æ„å›¾                                                 â”‚  â”‚
â”‚  â”‚   â”œâ”€ é€‰æ‹©Skill                                               â”‚  â”‚
â”‚  â”‚   â”œâ”€ æ‰§è¡ŒSkill â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚  â”‚   â”œâ”€ è¯„ä¼°ï¼ˆSimulatorï¼‰                 â”‚ è¿­ä»£å¾ªç¯             â”‚  â”‚
â”‚  â”‚   â””â”€ æ¡ä»¶è·¯ç”± â”€â”€â”€â”€ ä¸æ»¡è¶³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†‘â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Skillå±‚ (Tools)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ å“ç±»A    â”‚  â”‚ å“ç±»B    â”‚  â”‚ è¯„ä¼°     â”‚  â”‚ ç”¨æˆ·è‡ªå®šä¹‰â”‚           â”‚
â”‚  â”‚ Skill    â”‚  â”‚ Skill    â”‚  â”‚ Skill    â”‚  â”‚ Skill    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†‘â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ•°æ®å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚CreatorProfileâ”‚  â”‚ FieldSchema  â”‚  â”‚ Project Stateâ”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 æ–‡ä»¶ç»“æ„æ›´æ–°

```
/content_production_system
â”œâ”€â”€ /agent
â”‚   â”œâ”€â”€ orchestrator.py      # å…¨å±€è°ƒåº¦ï¼ˆStateGraphæˆ–è‡ªå»ºï¼‰
â”‚   â”œâ”€â”€ state.py             # çŠ¶æ€å®šä¹‰
â”‚   â””â”€â”€ router.py            # æ¡ä»¶è·¯ç”±é€»è¾‘
â”‚
â”œâ”€â”€ /skills
â”‚   â”œâ”€â”€ base.py              # SkillåŸºç±»
â”‚   â”œâ”€â”€ builtin/             # å†…ç½®Skill
â”‚   â”‚   â”œâ”€â”€ course_intro.py
â”‚   â”‚   â””â”€â”€ marketing.py
â”‚   â””â”€â”€ loader.py            # åŠ¨æ€åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰Skill
â”‚
â”œâ”€â”€ /core                    # åŸæœ‰çš„æ¨¡å—
â”‚   â”œâ”€â”€ models/
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ /ui
    â”œâ”€â”€ chat_handler.py      # å¯¹è¯æ¡†æ¶ˆæ¯å¤„ç†
    â””â”€â”€ ...
```



